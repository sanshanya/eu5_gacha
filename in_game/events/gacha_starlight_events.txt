namespace = gacha_starlight_events

# ==========================================
# 事件 1：星辉兑换主菜单
# ==========================================
gacha_starlight_events.1 = {
    type = country_event
    title = gacha_starlight_events.1.title
    desc  = gacha_starlight_events.1.desc
    

    immediate = {
        event_illustration_estate_effect = {
            foreground = estate_type:clergy_estate
            background = estate_type:clergy_estate
        }
    }

    # 选项1：兑换心海
    option = {
        name = gacha_starlight_events.1.xinhai
        trigger = {
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_xinhai_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_xinhai_modifier }
            }
        }
        
        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_xinhai_effect = yes
        }
    }
    
    # 选项2：兑换雷电将军
    option = {
        name = gacha_starlight_events.1.raiden
        trigger = {
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_raiden_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_raiden_modifier }
            }
        }
        
        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_raiden_effect = yes
        }
    }
    
    # 选项3：兑换刻晴
    option = {
        name = gacha_starlight_events.1.keqing
        trigger = {
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_keqing_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_keqing_modifier }
                AND = {
                    country_exists = c:GL1
                    c:GL1 = {
                        is_subject_of = root
                        any_character = { is_alive = yes has_character_modifier = gacha_keqing_modifier }
                    }
                }
            }
        }
        
        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_keqing_effect = yes
        }
    }
    
    # 选项4：兑换芙宁娜
    option = {
        name = gacha_starlight_events.1.furina
        trigger = {
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_furina_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_furina_modifier }
            }
        }
        
        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_furina_effect = yes
        }
    }
    
    # 选项5：兑换胡桃
    option = {
        name = gacha_starlight_events.1.hutao
        trigger = {
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_hutao_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_hutao_modifier }
            }
        }
        
        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_hutao_effect = yes
        }
    }

    option = {
        name = gacha_starlight_events.1.fischl
        trigger = {
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_fischl_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_fischl_modifier }
            }
        }
        
        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_fischl_effect = yes
        }
    }

    option = {
        name = gacha_starlight_events.1.klee
        trigger = {
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_klee_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_klee_modifier }
            }
        }
        
        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_klee_effect = yes
        }
    }
    
    option = {
        name = gacha_starlight_events.1.nahida
        trigger = {
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_nahida_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_nahida_modifier }
            }
        }
        
        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_nahida_effect = yes
        }
    }

    option = {
        name = gacha_starlight_events.1.ningguang
        trigger = {
            has_global_variable = gacha_liyue_pool_unlocked
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_ningguang_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_ningguang_modifier }
            }
        }

        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_ningguang_effect = yes
        }
    }

    option = {
        name = gacha_starlight_events.1.ganyu
        trigger = {
            has_global_variable = gacha_liyue_pool_unlocked
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_ganyu_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_ganyu_modifier }
            }
        }

        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_ganyu_effect = yes
        }
    }

    option = {
        name = gacha_starlight_events.1.beidou
        trigger = {
            has_global_variable = gacha_liyue_pool_unlocked
            var:gacha_starlight >= 3
            OR = {
                NOT = { has_global_variable = gacha_beidou_is_summoned }
                any_character = { is_alive = yes has_character_modifier = gacha_beidou_modifier }
            }
        }

        hidden_effect = {
            change_variable = { name = gacha_starlight subtract = 3 }
            gacha_create_beidou_effect = yes
        }
    }
    
    # 选项6：取消
    option = {
        name = gacha_starlight_events.1.cancel
        # 什么也不做
    }
}
