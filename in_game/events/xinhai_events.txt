namespace = xinhai_events

xinhai_events.1 = {
    type = country_event
    title = xinhai_events.1.title
    desc  = xinhai_events.1.desc
    fire_only_once = yes

    immediate = {
        # 1. 设置背景图
        event_illustration_estate_effect = {
            foreground = estate_type:peasants_estate
            background = estate_type:peasants_estate
        }

        # 2. 【关键】定位并初始化心海
        # 此时心海已经被通用脚本创造出来了，但还是个“素体”
        # 我们在这里找到她，并赋予她心海独有的特质和阶层
        random_in_global_list = {
            variable = gacha_obtained_characters
            limit = {
                # 使用“身份Modifier”来确认找到的是心海
                has_character_modifier = gacha_xinhai_modifier
            }
            save_scope_as = xinhai_character
            
            # === 在这里添加专属 Trait ===
            # 这样事件弹出来的时候，玩家看左边的立绘就能看到这些特质图标了
            
            # 统筹 / 内阁 / 文化影响：庙算无遗
            add_trait = trait:xinhai_miaosuan_trait

            # 民心 & 繁荣：海月之誓
            add_trait = trait:xinhai_sea_oath_trait

            # 海军向：海祇姬君 – Admiral 专用
            add_trait = trait:xinhai_sea_princess_trait
            
            # === 在这里设置阶层 ===
            # 将她归入王权/皇室阶层 (Crown Estate)
            change_character_estate = estate_type:crown_estate
        }
    }

    # 选项：欢迎加入
    option = {
        name = xinhai_events.1.a
        historical_option = yes
        custom_tooltip = xinhai_events.may_inspire_tt
        
        # 给予一点仪式感的奖励
        add_army_tradition = 5 
        
        # 播放音效 (可选)
        # play_sound = "event_character_join"
    }
}